# 键盘优先

**核心原则：快捷键 (Shortcuts) · 焦点管理 (Focus Trap) · 渐进式退出 (Progressive Escape)**

> **架构守护**: 快捷键由 `Shortcuts` + `Actions` 组件管理。

## 快捷键体系

**规则**: 所有核心操作必须绑定快捷键。

**快捷键规范**:
- **保存**: `Ctrl+S` (Windows) / `Cmd+S` (macOS)
- **关闭**: `Esc`
- **新建**: `Ctrl+N` / `Cmd+N`
- **搜索**: `Ctrl+F` / `Cmd+F`
- **撤销**: `Ctrl+Z` / `Cmd+Z`
- **重做**: `Ctrl+Shift+Z` / `Cmd+Shift+Z`

**实现**: 使用 Flutter 原生 `Shortcuts` + `Actions` 组件

**实现位置**: `lib/core/utils/keyboard_shortcuts.dart`

## 焦点管理 (Focus Trap)

**规则**: 模态框打开时，Tab 键焦点必须被限制在弹窗内。

**实现**:
- 使用 `FocusScope` 限制焦点范围
- 关闭模态框后恢复焦点到触发元素

## 渐进式退出 (Progressive Escape)

**规则**: 按下 `ESC` 时，必须按照 **LIFO (后进先出)** 顺序逐层撤销操作。

- Level 1: 关闭下拉菜单 / 清除当前输入焦点
- Level 2: 清空输入框内容
- Level 3: 关闭模态框 / 侧边栏

**实现**: 使用 `FocusScope` 和 `Shortcuts` 实现层级管理。

详见: [窗口管理](./窗口管理.md) | [无障碍设计](./无障碍设计.md)


